(function() {
  var ResultView, TextEditorView, WatchView, _;

  TextEditorView = require('atom-space-pen-views').TextEditorView;

  _ = require('lodash');

  ResultView = require('./result-view');

  module.exports = WatchView = (function() {
    function WatchView(kernel, grammar) {
      this.kernel = kernel;
      this.grammar = grammar;
      this.element = document.createElement('div');
      this.element.classList.add('hydrogen', 'watch-view');
      this.inputElement = new TextEditorView();
      this.inputElement.element.classList.add('watch-input');
      this.inputEditor = this.inputElement.getModel();
      this.inputEditor.setGrammar(this.grammar);
      this.inputEditor.setSoftWrapped(true);
      this.inputEditor.setLineNumberGutterVisible(false);
      this.inputEditor.moveToTop();
      this.resultView = new ResultView();
      this.resultView.setMultiline(true);
      this.element.appendChild(this.inputElement.element);
      this.element.appendChild(this.resultView.element);
    }

    WatchView.prototype.run = function() {
      var code;
      code = this.getCode();
      this.clearResults();
      console.log("watchview running:", code);
      if ((code != null) && (code.length != null) && code.length > 0) {
        return this.kernel.executeWatch(code, (function(_this) {
          return function(result) {
            console.log("watchview got result:", result);
            return _this.resultView.addResult(result);
          };
        })(this));
      }
    };

    WatchView.prototype.setCode = function(code) {
      this.inputEditor.setText(code);
      return this;
    };

    WatchView.prototype.getCode = function() {
      return this.inputElement.getText();
    };

    WatchView.prototype.clearResults = function() {
      var e;
      try {
        this.element.removeChild(this.resultView.element);
        this.resultView.destroy();
      } catch (_error) {
        e = _error;
        console.error(e);
      }
      this.resultView = new ResultView();
      this.resultView.setMultiline(true);
      return this.element.appendChild(this.resultView.element);
    };

    WatchView.prototype.destroy = function() {
      this.clearResults();
      return this.element.parentNode.removeChild(this.element);
    };

    return WatchView;

  })();

}).call(this);

//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAiZmlsZSI6ICIiLAogICJzb3VyY2VSb290IjogIiIsCiAgInNvdXJjZXMiOiBbCiAgICAiL1VzZXJzL1JhZC8uYXRvbS9wYWNrYWdlcy9oeWRyb2dlbi9saWIvd2F0Y2gtdmlldy5jb2ZmZWUiCiAgXSwKICAibmFtZXMiOiBbXSwKICAibWFwcGluZ3MiOiAiQUFBQTtBQUFBLE1BQUEsd0NBQUE7O0FBQUEsRUFBQyxpQkFBa0IsT0FBQSxDQUFRLHNCQUFSLEVBQWxCLGNBQUQsQ0FBQTs7QUFBQSxFQUNBLENBQUEsR0FBSSxPQUFBLENBQVEsUUFBUixDQURKLENBQUE7O0FBQUEsRUFHQSxVQUFBLEdBQWEsT0FBQSxDQUFRLGVBQVIsQ0FIYixDQUFBOztBQUFBLEVBS0EsTUFBTSxDQUFDLE9BQVAsR0FDTTtBQUVXLElBQUEsbUJBQUUsTUFBRixFQUFXLE9BQVgsR0FBQTtBQUNULE1BRFUsSUFBQyxDQUFBLFNBQUEsTUFDWCxDQUFBO0FBQUEsTUFEbUIsSUFBQyxDQUFBLFVBQUEsT0FDcEIsQ0FBQTtBQUFBLE1BQUEsSUFBQyxDQUFBLE9BQUQsR0FBVyxRQUFRLENBQUMsYUFBVCxDQUF1QixLQUF2QixDQUFYLENBQUE7QUFBQSxNQUNBLElBQUMsQ0FBQSxPQUFPLENBQUMsU0FBUyxDQUFDLEdBQW5CLENBQXVCLFVBQXZCLEVBQW1DLFlBQW5DLENBREEsQ0FBQTtBQUFBLE1BR0EsSUFBQyxDQUFBLFlBQUQsR0FBb0IsSUFBQSxjQUFBLENBQUEsQ0FIcEIsQ0FBQTtBQUFBLE1BSUEsSUFBQyxDQUFBLFlBQVksQ0FBQyxPQUFPLENBQUMsU0FBUyxDQUFDLEdBQWhDLENBQW9DLGFBQXBDLENBSkEsQ0FBQTtBQUFBLE1BTUEsSUFBQyxDQUFBLFdBQUQsR0FBZSxJQUFDLENBQUEsWUFBWSxDQUFDLFFBQWQsQ0FBQSxDQU5mLENBQUE7QUFBQSxNQU9BLElBQUMsQ0FBQSxXQUFXLENBQUMsVUFBYixDQUF3QixJQUFDLENBQUEsT0FBekIsQ0FQQSxDQUFBO0FBQUEsTUFRQSxJQUFD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

//# sourceURL=/Users/Rad/.atom/packages/hydrogen/lib/watch-view.coffee
