(function() {
  var fs, latinize, path, yaml;

  fs = require('fs');

  path = require('path');

  yaml = require('js-yaml');

  latinize = require('latinize');

  module.exports = {
    Main: null,
    setMainModule: function(Main) {
      this.Main = Main;
    },
    waitForConfig: function(cb) {
      if (process.jekyllAtom.config) {
        return cb(process.jekyllAtom.config);
      } else {
        return this.Main.disposables.push(this.Main.Emitter.on('config-loaded', (function(_this) {
          return function(conf) {
            return cb(conf);
          };
        })(this)));
      }
    },
    getConfigFromSite: function() {
      return fs.open(path.join(atom.project.getPaths()[0], '_config.yml'), 'r', (function(_this) {
        return function(err, fd) {
          return _this.handleConfigFileOpen(err, fd);
        };
      })(this));
    },
    handleConfigFileOpen: function(err, fd) {
      if (!err) {
        process.jekyllAtom.config = yaml.safeLoad(fs.readFileSync(path.join(atom.project.getPaths()[0], '_config.yml')));
        if (!process.jekyllAtom.config.layouts_dir) {
          process.jekyllAtom.config.layouts_dir = './_layouts';
        }
        if (!process.jekyllAtom.config.includes_dir) {
          process.jekyllAtom.config.includes_dir = './_includes';
        }
        if (!process.jekyllAtom.config.data_dir) {
          process.jekyllAtom.config.data_dir = './_data';
        }
        if (!process.jekyllAtom.config.destination) {
          process.jekyllAtom.config.destination = './_site';
        }
        if (!process.jekyllAtom.config.source) {
          process.jekyllAtom.config.source = '.';
        }
        if (!process.jekyllAtom.config.atom) {
          process.jekyllAtom.config.atom = {};
        }
        if (!process.jekyllAtom.config.atom.defaultPostDir) {
          process.jekyllAtom.config.atom.defaultPostDir = '_posts';
        }
        if (!process.jekyllAtom.config.atom.postDirs) {
          process.jekyllAtom.config.atom.postDirs = [];
        }
        process.jekyllAtom.config.atom.postDirs.unshift('_drafts');
        process.jekyllAtom.config.atom.postDirs.unshift('_posts');
        return this.Main.Emitter.emit('config-loaded', process.jekyllAtom.config);
      }
    },
    generateFileName: function(title) {
      var titleString;
      title = latinize(title);
      titleString = title.toLowerCase().replace(/[^\w\s]|_/g, "").replace(RegExp(" ", 'g'), "-");
      return this.generateDateString() + '-' + titleString;
    },
    generateDateString: function(currentTime, showTime) {
      var string, timezoneOffset;
      if (currentTime == null) {
        currentTime = new Date();
      }
      if (showTime == null) {
        showTime = false;
      }
      string = currentTime.getFullYear() + "-" + ("0" + (currentTime.getMonth() + 1)).slice(-2) + "-" + ("0" + currentTime.getDate()).slice(-2);
      if (showTime) {
        string += " " + ("0" + currentTime.getHours()).slice(-2) + ":" + ("0" + currentTime.getMinutes()).slice(-2) + ":" + ("0" + currentTime.getSeconds()).slice(-2);
        timezoneOffset = currentTime.getTimezoneOffset();
        string += " " + (timezoneOffset <= 0 ? "+" : "-") + ("0" + Math.floor(Math.abs(timezoneOffset) / 60)).slice(-2) + ("0" + Math.abs(timezoneOffset) % 60).slice(-2);
      }
      return string;
    },
    scan: function(string, pattern) {
      var matches, results;
      matches = [];
      results = [];
      while (matches = pattern.exec(string)) {
        matches.shift();
        results.push(matches);
      }
      return results;
    },
    getPostTitle: function(editor) {
      var contents, title;
      contents = editor.getText();
      return title = this.scan(contents, /title: (.*?)[\r\n|\n\r|\r|\n]/g)[0][0];
    }
  };

}).call(this);

//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAiZmlsZSI6ICIiLAogICJzb3VyY2VSb290IjogIiIsCiAgInNvdXJjZXMiOiBbCiAgICAiL1VzZXJzL1JhZC8uYXRvbS9wYWNrYWdlcy9qZWt5bGwvbGliL2pla3lsbC91dGlscy5jb2ZmZWUiCiAgXSwKICAibmFtZXMiOiBbXSwKICAibWFwcGluZ3MiOiAiQUFBQTtBQUFBLE1BQUEsd0JBQUE7O0FBQUEsRUFBQSxFQUFBLEdBQUssT0FBQSxDQUFRLElBQVIsQ0FBTCxDQUFBOztBQUFBLEVBQ0EsSUFBQSxHQUFPLE9BQUEsQ0FBUSxNQUFSLENBRFAsQ0FBQTs7QUFBQSxFQUVBLElBQUEsR0FBTyxPQUFBLENBQVEsU0FBUixDQUZQLENBQUE7O0FBQUEsRUFJQSxRQUFBLEdBQVcsT0FBQSxDQUFRLFVBQVIsQ0FKWCxDQUFBOztBQUFBLEVBTUEsTUFBTSxDQUFDLE9BQVAsR0FDRTtBQUFBLElBQUEsSUFBQSxFQUFNLElBQU47QUFBQSxJQUVBLGFBQUEsRUFBZSxTQUFFLElBQUYsR0FBQTtBQUFTLE1BQVIsSUFBQyxDQUFBLE9BQUEsSUFBTyxDQUFUO0lBQUEsQ0FGZjtBQUFBLElBSUEsYUFBQSxFQUFlLFNBQUMsRUFBRCxHQUFBO0FBQ2IsTUFBQSxJQUFHLE9BQU8sQ0FBQyxVQUFVLENBQUMsTUFBdEI7ZUFDRSxFQUFBLENBQUcsT0FBTyxDQUFDLFVBQVUsQ0FBQyxNQUF0QixFQURGO09BQUEsTUFBQTtlQUdFLElBQUMsQ0FBQSxJQUFJLENBQUMsV0FBVyxDQUFDLElBQWxCLENBQXVCLElBQUMsQ0FBQSxJQUFJLENBQUMsT0FBTyxDQUFDLEVBQWQsQ0FBaUIsZUFBakIsRUFBa0MsQ0FBQSxTQUFBLEtBQUEsR0FBQTtpQkFBQSxTQUFDLElBQUQsR0FBQTttQkFBVSxFQUFBLENBQUcsSUFBSCxFQUFWO1VBQUEsRUFBQTtRQUFBLENBQUEsQ0FBQSxDQUFBLElBQUEsQ0FBbEMsQ0FBdkIsRUFIRjtPQURhO0lBQUEsQ0FKZjtBQUFBLElBVUEsaUJBQUEsRUFBbUIsU0FBQSxH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

//# sourceURL=/Users/Rad/.atom/packages/jekyll/lib/jekyll/utils.coffee
