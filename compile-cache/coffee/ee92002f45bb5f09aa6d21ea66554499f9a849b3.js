(function() {
  var fs, path, yaml;

  fs = require('fs');

  path = require('path');

  yaml = require('js-yaml');

  module.exports = {
    Main: null,
    setMainModule: function(Main) {
      this.Main = Main;
    },
    waitForConfig: function(cb) {
      if (process.jekyllAtom.config) {
        return cb(process.jekyllAtom.config);
      } else {
        return this.Main.disposables.push(this.Main.Emitter.on('config-loaded', (function(_this) {
          return function(conf) {
            return cb(conf);
          };
        })(this)));
      }
    },
    getConfigFromSite: function() {
      return fs.open(path.join(atom.project.getPaths()[0], '_config.yml'), 'r', (function(_this) {
        return function(err, fd) {
          return _this.handleConfigFileOpen(err, fd);
        };
      })(this));
    },
    handleConfigFileOpen: function(err, fd) {
      if (!err) {
        process.jekyllAtom.config = yaml.safeLoad(fs.readFileSync(path.join(atom.project.getPaths()[0], '_config.yml')));
        if (!process.jekyllAtom.config.layouts_dir) {
          process.jekyllAtom.config.layouts_dir = './_layouts';
        }
        if (!process.jekyllAtom.config.includes_dir) {
          process.jekyllAtom.config.includes_dir = './_includes';
        }
        if (!process.jekyllAtom.config.data_dir) {
          process.jekyllAtom.config.data_dir = './_data';
        }
        if (!process.jekyllAtom.config.destination) {
          process.jekyllAtom.config.destination = './_site';
        }
        if (!process.jekyllAtom.config.source) {
          process.jekyllAtom.config.source = '.';
        }
        if (!process.jekyllAtom.config.atom) {
          process.jekyllAtom.config.atom = {};
        }
        if (!process.jekyllAtom.config.atom.defaultPostDir) {
          process.jekyllAtom.config.atom.defaultPostDir = '_posts';
        }
        if (!process.jekyllAtom.config.atom.postDirs) {
          process.jekyllAtom.config.atom.postDirs = [];
        }
        process.jekyllAtom.config.atom.postDirs.unshift('_drafts');
        process.jekyllAtom.config.atom.postDirs.unshift('_posts');
        return this.Main.Emitter.emit('config-loaded', process.jekyllAtom.config);
      }
    },
    generateFileName: function(title) {
      var titleString;
      titleString = title.toLowerCase().replace(/[^\w\s]|_/g, "").replace(RegExp(" ", 'g'), "-");
      return this.generateDateString() + '-' + titleString;
    },
    generateDateString: function(currentTime, showTime) {
      var string, timezoneOffset;
      if (currentTime == null) {
        currentTime = new Date();
      }
      if (showTime == null) {
        showTime = false;
      }
      string = currentTime.getFullYear() + "-" + ("0" + (currentTime.getMonth() + 1)).slice(-2) + "-" + ("0" + currentTime.getDate()).slice(-2);
      if (showTime) {
        string += " " + ("0" + currentTime.getHours()).slice(-2) + ":" + ("0" + currentTime.getMinutes()).slice(-2) + ":" + ("0" + currentTime.getSeconds()).slice(-2);
        timezoneOffset = currentTime.getTimezoneOffset();
        string += " " + (timezoneOffset <= 0 ? "+" : "-") + ("0" + Math.floor(Math.abs(timezoneOffset) / 60)).slice(-2) + ("0" + Math.abs(timezoneOffset) % 60).slice(-2);
      }
      return string;
    },
    scan: function(string, pattern) {
      var matches, results;
      matches = [];
      results = [];
      while (matches = pattern.exec(string)) {
        matches.shift();
        results.push(matches);
      }
      return results;
    },
    getPostTitle: function(editor) {
      var contents, title;
      contents = editor.getText();
      return title = this.scan(contents, /title: (.*?)[\r\n|\n\r|\r|\n]/g)[0][0];
    }
  };

}).call(this);

//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAiZmlsZSI6ICIiLAogICJzb3VyY2VSb290IjogIiIsCiAgInNvdXJjZXMiOiBbCiAgICAiL1VzZXJzL1JhZC8uYXRvbS9wYWNrYWdlcy9qZWt5bGwvbGliL2pla3lsbC91dGlscy5jb2ZmZWUiCiAgXSwKICAibmFtZXMiOiBbXSwKICAibWFwcGluZ3MiOiAiQUFBQTtBQUFBLE1BQUEsY0FBQTs7QUFBQSxFQUFBLEVBQUEsR0FBSyxPQUFBLENBQVEsSUFBUixDQUFMLENBQUE7O0FBQUEsRUFDQSxJQUFBLEdBQU8sT0FBQSxDQUFRLE1BQVIsQ0FEUCxDQUFBOztBQUFBLEVBRUEsSUFBQSxHQUFPLE9BQUEsQ0FBUSxTQUFSLENBRlAsQ0FBQTs7QUFBQSxFQUlBLE1BQU0sQ0FBQyxPQUFQLEdBQ0U7QUFBQSxJQUFBLElBQUEsRUFBTSxJQUFOO0FBQUEsSUFFQSxhQUFBLEVBQWUsU0FBRSxJQUFGLEdBQUE7QUFBUyxNQUFSLElBQUMsQ0FBQSxPQUFBLElBQU8sQ0FBVDtJQUFBLENBRmY7QUFBQSxJQUlBLGFBQUEsRUFBZSxTQUFDLEVBQUQsR0FBQTtBQUNiLE1BQUEsSUFBRyxPQUFPLENBQUMsVUFBVSxDQUFDLE1BQXRCO2VBQ0UsRUFBQSxDQUFHLE9BQU8sQ0FBQyxVQUFVLENBQUMsTUFBdEIsRUFERjtPQUFBLE1BQUE7ZUFHRSxJQUFDLENBQUEsSUFBSSxDQUFDLFdBQVcsQ0FBQyxJQUFsQixDQUF1QixJQUFDLENBQUEsSUFBSSxDQUFDLE9BQU8sQ0FBQyxFQUFkLENBQWlCLGVBQWpCLEVBQWtDLENBQUEsU0FBQSxLQUFBLEdBQUE7aUJBQUEsU0FBQyxJQUFELEdBQUE7bUJBQVUsRUFBQSxDQUFHLElBQUgsRUFBVjtVQUFBLEVBQUE7UUFBQSxDQUFBLENBQUEsQ0FBQSxJQUFBLENBQWxDLENBQXZCLEVBSEY7T0FEYTtJQUFBLENBSmY7QUFBQSxJQVVBLGlCQUFBLEVBQW1CLFNBQUEsR0FBQTthQUNqQixFQUFFLENBQUMsSUFBSCxDQUNFLElBQUksQ0FBQyxJQUFMLENB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

//# sourceURL=/Users/Rad/.atom/packages/jekyll/lib/jekyll/utils.coffee
